---
title: "Tables and Figures"
author: "me"
date: "November 2019"
output:
  pdf_document:
    keep_tex: true
header-includes:
   - \usepackage{dcolumn}    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Google Drive/Research Assistant/Work With David Knight/Survey of the Incarcerated/1st Stage Memo/Graphs")
library(tidyverse)
library(stargazer)
```

## Topic 1 or Topic 2
Read in the S3053 dataset.
```{r, echo=FALSE}
lrdata3 <- read.csv("lrdata3.csv")

lrdata3$fst1n2 <- as.integer(as.logical(lrdata3$fst1n2))
lrdata3$snd1n2 <- as.integer(as.logical(lrdata3$snd1n2))
lrdata3$trd1n2 <- as.integer(as.logical(lrdata3$trd1n2))
```

1. Keep All
```{r, echo=FALSE}
lrdata3.1 <- lrdata3 %>% 
  select(-c("X", "Survey_ID", "unsure_race", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst1n2 ~ . - snd1n2 - trd1n2, lrdata3.1, family = binomial(link = "probit"))
model2 <- glm(snd1n2 ~ . - fst1n2 - trd1n2, lrdata3.1, family = binomial(link = "probit"))
model3 <- glm(trd1n2 ~ . - snd1n2 - fst1n2, lrdata3.1, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="Linear Results of being topic 1 or topic 2", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

2. Delete "white"
```{r, echo=FALSE}
lrdata3.2 <- lrdata3 %>% 
  select(-c("X", "Survey_ID", "white", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst1n2 ~ . - snd1n2 - trd1n2, lrdata3.2, family = binomial(link = "probit"))
model2 <- glm(snd1n2 ~ . - fst1n2 - trd1n2, lrdata3.2, family = binomial(link = "probit"))
model3 <- glm(trd1n2 ~ . - snd1n2 - fst1n2, lrdata3.2, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 1 or topic 2 \\\\ Using white people as the base}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

3. Delete "black"
```{r, echo=FALSE}
lrdata3.3 <- lrdata3 %>% 
  select(-c("X", "Survey_ID", "black", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst1n2 ~ . - snd1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model2 <- glm(snd1n2 ~ . - fst1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model3 <- glm(trd1n2 ~ . - snd1n2 - fst1n2, lrdata3.3, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 1 or topic 2 \\\\ Using black people as the base}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

4. Only keep "white"
```{r, echo=FALSE}
lrdata3.3 <- lrdata3 %>% 
  select(-c("X", "Survey_ID", "black", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst1n2 ~ . - snd1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model2 <- glm(snd1n2 ~ . - fst1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model3 <- glm(trd1n2 ~ . - snd1n2 - fst1n2, lrdata3.3, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 1 or topic 2 \\\\ Only keep white racial dummy varaible}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```


5. Only keep "black"
```{r, echo=FALSE}
lrdata3.3 <- lrdata3 %>% 
  select(-c("X", "Survey_ID", "white", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst1n2 ~ . - snd1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model2 <- glm(snd1n2 ~ . - fst1n2 - trd1n2, lrdata3.3, family = binomial(link = "probit"))
model3 <- glm(trd1n2 ~ . - snd1n2 - fst1n2, lrdata3.3, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 1 or topic 2 \\\\ Only keep black racial dummy varaible}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

## Topic 4 or Topic 5
Read in the S3053 dataset.
```{r, echo=FALSE}
lrdata6 <- read.csv("lrdata6.csv")

lrdata6$fst4o5 <- as.integer(as.logical(lrdata6$fst4o5))
lrdata6$snd4o5 <- as.integer(as.logical(lrdata6$snd4o5))
lrdata6$trd4o5 <- as.integer(as.logical(lrdata6$trd4o5))
```

1. Keep All
```{r, echo=FALSE}
lrdata6.1 <- lrdata6 %>% 
  select(-c("X", "Survey_ID", "unsure_race", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4o5 ~ . - snd4o5 - trd4o5, lrdata6.1, family = binomial(link = "probit"))
model2 <- glm(snd4o5 ~ . - fst4o5 - trd4o5, lrdata6.1, family = binomial(link = "probit"))
model3 <- glm(trd4o5 ~ . - snd4o5 - fst4o5, lrdata6.1, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="Linear Results of being topic 4 or topic 5", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

2. Only keep "white"
```{r, echo=FALSE}
lrdata6.2 <- lrdata6 %>% 
  select(-c("X", "Survey_ID", "black", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4o5 ~ . - snd4o5 - trd4o5, lrdata6.2, family = binomial(link = "probit"))
model2 <- glm(snd4o5 ~ . - fst4o5 - trd4o5, lrdata6.2, family = binomial(link = "probit"))
model3 <- glm(trd4o5 ~ . - snd4o5 - fst4o5, lrdata6.2, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 or topic 5 \\\\ Only keep white racial dummy varaible}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

## Topic 4 
Read in the S3053 dataset.
```{r, echo=FALSE}
lrdata4 <- read.csv("lrdata4.csv")

lrdata4$fst4 <- as.integer(as.logical(lrdata4$fst4))
lrdata4$snd4 <- as.integer(as.logical(lrdata4$snd4))
lrdata4$trd4 <- as.integer(as.logical(lrdata4$trd4))
```

1. Delete "white"
```{r, echo=FALSE}
lrdata4.1 <- lrdata4 %>% 
  select(-c("X", "Survey_ID", "white", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.1, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.1, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.1, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Using white people as the base}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

2. Delete "black"
```{r, echo=FALSE}
lrdata4.2 <- lrdata4 %>% 
  select(-c("X", "Survey_ID", "black", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.2, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.2, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.2, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Using black people as the base}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

3. Only keep "white"
```{r, echo=FALSE}
lrdata4.3 <- lrdata4 %>% 
  select(-c("X", "Survey_ID", "black", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.3, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.3, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.3, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Only keep white racial dummy varaible}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```


4. Only keep "black"
```{r, echo=FALSE}
lrdata4.4 <- lrdata4 %>% 
  select(-c("X", "Survey_ID", "white", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.4, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.4, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.4, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Only keep black racial dummy varaible}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

## Topic 4 for non-white sample
Read in the S3053 dataset.
```{r, echo=FALSE}
lrdata4_nw <- read.csv("lrdata_nw4.csv")

lrdata4_nw$fst4 <- as.integer(as.logical(lrdata4_nw$fst4))
lrdata4_nw$snd4 <- as.integer(as.logical(lrdata4_nw$snd4))
lrdata4_nw$trd4 <- as.integer(as.logical(lrdata4_nw$trd4))
```

1. Delete "black"
```{r, echo=FALSE}
lrdata4.1_nw <- lrdata4_nw %>% 
  select(-c("X", "Survey_ID", "black", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.1_nw, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.1_nw, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.1_nw, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Using black people as the base \\\\ For non-white sample}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

2. Only keep "black"
```{r, echo=FALSE}
lrdata4.2_nw <- lrdata4_nw %>% 
  select(-c("X", "Survey_ID", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst4 ~ . - snd4 - trd4, lrdata4.2_nw, family = binomial(link = "probit"))
model2 <- glm(snd4 ~ . - fst4 - trd4, lrdata4.2_nw, family = binomial(link = "probit"))
model3 <- glm(trd4 ~ . - snd4 - fst4, lrdata4.2_nw, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 4 \\\\ Only keep black racial dummy varaible \\\\ For non-white sample}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

## Topic 5 for non-white sample
Read in the S3053 dataset.
```{r, echo=FALSE}
lrdata5_nw <- read.csv("lrdata_nw5.csv")

lrdata5_nw$fst5 <- as.integer(as.logical(lrdata5_nw$fst5))
lrdata5_nw$snd5 <- as.integer(as.logical(lrdata5_nw$snd5))
lrdata5_nw$trd5 <- as.integer(as.logical(lrdata5_nw$trd5))
```

1. Delete "black"
```{r, echo=FALSE}
lrdata5.1_nw <- lrdata5_nw %>% 
  select(-c("X", "Survey_ID", "black", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst5 ~ . - snd5 - trd5, lrdata5.1_nw, family = binomial(link = "probit"))
model2 <- glm(snd5 ~ . - fst5 - trd5, lrdata5.1_nw, family = binomial(link = "probit"))
model3 <- glm(trd5 ~ . - snd5 - fst5, lrdata5.1_nw, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 5 \\\\ Using black people as the base \\\\ For non-white sample}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```

2. Only keep "black"
```{r, echo=FALSE}
lrdata5.2_nw <- lrdata5_nw %>% 
  select(-c("X", "Survey_ID", "native", "asian", "hawaiian",
            "other_race", "unsure_race", "latinx", "age_Under.18", 
         "gender_Gender.non.conforming.or.non.binary.or.other"))
model1 <- glm(fst5 ~ . - snd5 - trd5, lrdata5.2_nw, family = binomial(link = "probit"))
model2 <- glm(snd5 ~ . - fst5 - trd5, lrdata5.2_nw, family = binomial(link = "probit"))
model3 <- glm(trd5 ~ . - snd5 - fst5, lrdata5.2_nw, family = binomial(link = "probit"))
```

```{r, echo=FALSE, results='asis'}
stargazer(model1, model2, model3, title="\\shortstack{Linear Results of being topic 5 \\\\ Only keep black racial dummy varaible \\\\ For non-white sample}", 
          font.size = "small",
          align = TRUE,
          single.row = TRUE,
          column.sep.width = "-15pt")
```
